<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, user-scalable=yes, minimal-ui">
    <title>06 SVG</title>
    <link href="../index.css" rel="stylesheet">
    <script crossorigin="anonymous" src="https://kit.fontawesome.com/311699e670.js"></script>
    <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/monokai-sublime.min.css"
          rel="stylesheet">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <script>hljs.configure({languages: ['javascript']})</script>
    <script>hljs.highlightAll();</script>
    <script>
        /* Toggle between adding and removing the "responsive" class to topnav when the user clicks on the icon
        * https://www.w3schools.com/howto/howto_js_topnav_responsive.asp */
        function myFunction() {
            var x = document.getElementById("mySidenav");
            if (x.className === "sidenav") {
                x.className += " responsive";
            } else {
                x.className = "sidenav";
            }
        }
    </script>
</head>
<body>
<div class="sidenav" id="mySidenav">
    <a href="../index.html" style="display: block"><i class="fa fa-home"></i></a>
    <a href="../01_Einfuehrung/uebung01.html" class="active">01 Einführung</a>
    <a href="../02_RWD/uebung02.html">02 RWD</a>
    <a href="../03_JavaScript/uebung03.html">03 JavaScript</a>
    <a href="../04_DOM/uebung04.html">04 DOM</a>
    <a href="../05_Async/uebung05.html">05 Async</a>
    <a href="../06_SVG/uebung06.html">06 SVG</a>
    <a href="../07_node/uebung07.html">07 Node</a>
    <a href="../08_ModularWeb/uebung08.html">08 ModularWeb</a>
    <a href="../09_PWA/uebung09.html">09 PWA</a>
    <a href="../10_Vue/uebung10.html">10 Vue</a>
    <a href="../11_WebAssembly/uebung11.html">11 WebAssembly</a>
    <a href="../12_Security/uebung12.html">12 Security</a>
    <a href="javascript:void(0);" class="icon" onclick="myFunction()">
        <i class="fa fa-bars"></i>
    </a>
</div>
<div class="main">
    <h1>Übung 06 - SVG</h1>

    <details>
        <summary>6.1 - Statistik-Balkendiagramm in SVG
            <a style="display: inline;" href="balkendiagramm.html" target="_blank">
                &nbsp;
                <i class="fas fa-external-link-alt"></i></a></summary>
        <button id="bdcodebutton" onclick="buttonChange('bdcode','bdcomp')">Code</button>
        <button disabled id="bdcompbutton" onclick="buttonChange('bdcomp', 'bdcode')">
            Komponente
        </button>

        <div id="bdcomp">
            <iframe frameborder="0" style="width: 100%; height: 40vh; margin-top: 1em; resize: both"
                    src="balkendiagramm.html"></iframe>
        </div>
        <div id="bdcode" style="display: none">
                            <pre>
                                <code class="language-html">
    &lt;!DOCTYPE html>
    &lt;html lang="en">
    &lt;head>
        &lt;meta charset="UTF-8">
        &lt;title>Statistik-Balkendiagramm in SVG&lt;/title>
        &lt;style>
            .bar{
                animation-name: barAnim;
                animation-duration: 1.5s;
                animation-iteration-count: 1;
                animation-timing-function: ease;
                animation-play-state: running;
            }
            @keyframes barAnim {
                0%{
                    width: 0;
                }
            }
        &lt;/style>

    &lt;/head>
    &lt;body>
    &lt;h2>Die 736 Sitze des 20. Deutschen Bundestages verteilen sich wie folgt:&lt;/h2>
    &lt;svg height="500" id="dia" width="600" xmlns="http://www.w3.org/2000/svg">
        &lt;line x1="99" y1="25" x2="99" y2="240" stroke-width="2" stroke="#85adad" />&lt;text x="95" y="260">0&lt;/text>
        &lt;line x1="200" y1="25" x2="200" y2="240" stroke-width="2" stroke="#85adad" />&lt;text x="192" y="260">50&lt;/text>
        &lt;line x1="300" y1="25" x2="300" y2="240" stroke-width="2" stroke="#85adad" />&lt;text x="288" y="260">100&lt;/text>
        &lt;line x1="400" y1="25" x2="400" y2="240" stroke-width="2" stroke="#85adad" />&lt;text x="388" y="260">150&lt;/text>
        &lt;line x1="500" y1="25" x2="500" y2="240" stroke-width="2" stroke="#85adad" />&lt;text x="488" y="260">200&lt;/text>
        &lt;text font-family='Arial' font-size="12" x="350" y="280">Sitze im deutschen Parlament&lt;/text>
    &lt;/svg>
    &lt;/body>
    &lt;script>
        let data = {
            "spd": {
                name: "SPD",
                sitze: 206,
                color: "red"
            },
            "cdu/cdsu": {
                name: "CDU/CSU",
                sitze: 197,
                color: "black"
            },
            gruen:{
                name: "Die Grünen",
                sitze: 118,
                color: "green",
            },
            fdp:{
                name: "FDP",
                sitze: 92,
                color: "yellow",
            },
            afd:{
                name: "AfD",
                sitze: 82,
                color: "#4d2600",
            },
            linke:{
                name: "Die Linke",
                sitze: 39,
                color: "#e60e98",
            },
            franktionslos:{
                name: "franktionslos",
                sitze: 2,
                color: "grey"
            }
        }
        let stat= document.getElementById("dia");
        let y = 35;
        for (let d in data) {
            stat.innerHTML += `
                    &lt;text font-family='Arial' font-size='14' x='10' y=${y+15}>${data[d].name}&lt;/text>
                    &lt;rect class="bar" onmouseover="highlight(this);" onmouseout="reversehighlight()" fill='${data[d].color}' height='20' width='${data[d].sitze*2}' x='100' y='${y}'/>
                    &lt;text font-family='Arial' font-size='12' font-weight="bold" x='${110+data[d].sitze*2 }' y='${y+15}'>${data[d].sitze}&lt;/text>

                `
            y +=30;
        }
        function reversehighlight(el){
            const rects = document.getElementById("dia").getElementsByTagName('rect');
            for(let rect of rects){
                if (rect.id !== "bg") rect.style.opacity = 1.0;
            }
        }

        function highlight(el){
            const rects = document.getElementById("dia").getElementsByTagName('rect');
            for(let rect of rects){
                if (rect.id !== "bg") rect.style.opacity = 0.5;
            }
            el.style.opacity = 1.0;
        }
    &lt;/script>
    &lt;/html>
                                </code>
                            </pre>
        </div>

    </details>

    <details>
        <summary>6.2 - SVG Bezier-Animation
            <a style="display: inline;" href="bezier.html" target="_blank">
                &nbsp;
                <i class="fas fa-external-link-alt"></i></a></summary>
        <button id="beziercodebutton" onclick="buttonChange('beziercode','beziercomp')">Code</button>
        <button disabled id="beziercompbutton" onclick="buttonChange('beziercomp', 'beziercode')">
            Komponente
        </button>

        <div id="beziercomp">
            <iframe frameborder="0" style="width: 100%; height: 40vh; margin-top: 1em; resize: both"
                    src="bezier.html"></iframe>
        </div>
        <div id="beziercode" style="display: none">
                            <pre>
                                <code class="language-html">
    &lt;!DOCTYPE html>
    &lt;html lang="en" style="width:100%;height:100%;">
    &lt;head>
        &lt;meta charset="UTF-8">
        &lt;title>Quadratic Bézier&lt;/title>
        &lt;style>
            .draggable {
                cursor: move;
            }

            .static {
                cursor: not-allowed;
            }
        &lt;/style>
        &lt;script>
            window.onload = function () {

                draw();
                for (const draggable of document.querySelectorAll('.draggable')) {
                    makeDraggable(draggable);
                }
            }

            // Draggable functionality by Peter Collingridge https://www.petercollingridge.co.uk/tutorials/svg/interactive/dragging/
            function makeDraggable(elem) {
                elem.addEventListener('mousedown', startDrag);
                elem.addEventListener('mousemove', drag);
                elem.addEventListener('mouseup', endDrag);
                elem.addEventListener('mouseleave', endDrag);

                let selectedElement, offset;

                function startDrag(evt) {
                    console.log("drag")
                    if (evt.target.classList.contains('draggable')) {
                        selectedElement = evt.target;
                        offset = getMousePosition(evt);
                        offset.x -= parseFloat(selectedElement.getAttribute("cx"));
                        offset.y -= parseFloat(selectedElement.getAttribute("cy"));
                    }
                }


                function drag(evt) {
                    if (selectedElement) {
                        evt.preventDefault();
                        var coord = getMousePosition(evt);
                        selectedElement.setAttribute("cx", coord.x - offset.x);
                        selectedElement.setAttribute("cy", coord.y - offset.y);
                    }
                    draw();
                }

                function endDrag(evt) {
                    selectedElement = null;
                    draw();
                }

                function getMousePosition(evt) {
                    const CTM = svg.getScreenCTM();
                    return {
                        x: (evt.clientX - CTM.e) / CTM.a,
                        y: (evt.clientY - CTM.f) / CTM.d
                    };
                }
            }

            function draw() {
                const green = document.getElementById('green');
                const blue = document.getElementById('blue');
                const red = document.getElementById('red');
                let path = `M${red.getAttribute("cx")},${red.getAttribute("cy")}
                L${green.getAttribute("cx")},${green.getAttribute("cy")}
                L${blue.getAttribute("cx")},${blue.getAttribute("cy")}
                M${red.getAttribute("cx")},${red.getAttribute("cy")}
                Q${green.getAttribute("cx")},${green.getAttribute("cy")} ${blue.getAttribute("cx")},${blue.getAttribute("cy")}`
                document.getElementById("lines").innerHTML = `&lt;path class="static" d="${path}" stroke="black" stroke-width="3" fill="none"/>`
            }

        &lt;/script>
    &lt;/head>
    &lt;body style="width:100%;height:100%;margin:0;">
    &lt;svg height="100%" id="svg" style="margin-left: auto; margin-right: auto; display: block;" width="100%">
        &lt;circle class="draggable" cx="220" cy="60" fill="blue" id="blue" r="20">&lt;/circle>
        &lt;circle class="draggable" cx="102" cy="233" fill="red" id="red" r="20">&lt;/circle>
        &lt;circle class="draggable" cx="50" cy="110" fill="green" id="green" r="20">&lt;/circle>
        &lt;g id="lines">
        &lt;/g>
    &lt;/svg>
    &lt;/body>
    &lt;/html>
                                </code>
                            </pre>
        </div>

    </details>

    <details>
        <summary>6.3 - Calligraphy Editor
            <a style="display: inline;" href="calligraphy.html" target="_blank">
                &nbsp;
                <i class="fas fa-external-link-alt"></i></a></summary>
        <button id="callicodebutton" onclick="buttonChange('callicode','callicomp')">Code</button>
        <button disabled id="callicompbutton" onclick="buttonChange('callicomp', 'callicode')">
            Komponente
        </button>

        <div id="callicomp">
            <iframe frameborder="0" style="width: 100%; height: 40vh; margin-top: 1em; resize: both"
                    src="calligraphy.html"></iframe>
        </div>
        <div id="callicode" style="display: none">
                            <pre>
                                <code class="language-html">
    &lt;!DOCTYPE html>
    &lt;html lang="en" style="width:100%;height:100%;">
    &lt;head>
        &lt;meta charset="UTF-8">
        &lt;title>Quadratic Bézier&lt;/title>
        &lt;style>
            .draggable {
                cursor: move;
            }

            .static {
                cursor: not-allowed;
            }
        &lt;/style>
        &lt;script>
            window.onload = function () {

                draw();
                for (const draggable of document.querySelectorAll('.draggable')) {
                    makeDraggable(draggable);
                }
            }

            // Draggable functionality by Peter Collingridge https://www.petercollingridge.co.uk/tutorials/svg/interactive/dragging/
            function makeDraggable(elem) {
                elem.addEventListener('mousedown', startDrag);
                elem.addEventListener('mousemove', drag);
                elem.addEventListener('mouseup', endDrag);
                elem.addEventListener('mouseleave', endDrag);

                let selectedElement, offset;

                function startDrag(evt) {
                    console.log("drag")
                    if (evt.target.classList.contains('draggable')) {
                        selectedElement = evt.target;
                        offset = getMousePosition(evt);
                        offset.x -= parseFloat(selectedElement.getAttribute("cx"));
                        offset.y -= parseFloat(selectedElement.getAttribute("cy"));
                    }
                }


                function drag(evt) {
                    if (selectedElement) {
                        evt.preventDefault();
                        var coord = getMousePosition(evt);
                        selectedElement.setAttribute("cx", coord.x - offset.x);
                        selectedElement.setAttribute("cy", coord.y - offset.y);
                    }
                    draw();
                }

                function endDrag(evt) {
                    selectedElement = null;
                    draw();
                }

                function getMousePosition(evt) {
                    const CTM = svg.getScreenCTM();
                    return {
                        x: (evt.clientX - CTM.e) / CTM.a,
                        y: (evt.clientY - CTM.f) / CTM.d
                    };
                }
            }

            function draw() {
                const green = document.getElementById('green');
                const blue = document.getElementById('blue');
                const red = document.getElementById('red');
                let path = `M${red.getAttribute("cx")},${red.getAttribute("cy")}
                L${green.getAttribute("cx")},${green.getAttribute("cy")}
                L${blue.getAttribute("cx")},${blue.getAttribute("cy")}
                M${red.getAttribute("cx")},${red.getAttribute("cy")}
                Q${green.getAttribute("cx")},${green.getAttribute("cy")} ${blue.getAttribute("cx")},${blue.getAttribute("cy")}`
                document.getElementById("lines").innerHTML = `&lt;path class="static" d="${path}" stroke="black" stroke-width="3" fill="none"/>`
            }

        &lt;/script>
    &lt;/head>
    &lt;body style="width:100%;height:100%;margin:0;">
    &lt;svg height="100%" id="svg" style="margin-left: auto; margin-right: auto; display: block;" width="100%">
        &lt;circle class="draggable" cx="220" cy="60" fill="blue" id="blue" r="20">&lt;/circle>
        &lt;circle class="draggable" cx="102" cy="233" fill="red" id="red" r="20">&lt;/circle>
        &lt;circle class="draggable" cx="50" cy="110" fill="green" id="green" r="20">&lt;/circle>
        &lt;g id="lines">
        &lt;/g>
    &lt;/svg>
    &lt;/body>
    &lt;/html>
                                </code>
                            </pre>
        </div>

    </details>
</div>
<script>
    function buttonChange(own, other) {
        document.getElementById(own).style.display = 'block';
        document.getElementById(other).style.display = 'none'
        document.getElementById(own + 'button').disabled = true;
        document.getElementById(other + 'button').disabled = false;
    }
</script>
</body>
</html>